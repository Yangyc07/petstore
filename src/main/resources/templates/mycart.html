<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>米乐宠物商城</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <style>
        .carousel-inner .item img {
            width: 100%; /* or width: 100% !important; */
            height: 80%;
        }

        .hse1{ color: #f80910
        }
        .price{
            top:95%;
            height: 25%;
            width:100%;
            background-color: #f2faee;
        }
        .myright{
            float: right;
        }
        .myfoot{
            margin-left: 10%;
            width: 80%;
            height: 70px;
            position: absolute;
            bottom:0;
            left: 0;
        }

    </style>
</head>
<body th:style="'background:url('+ '/petstore/assets/global/img/bg.jpg'+ ');'">
<div class="storeheader">
    <nav class="navbar navbar-default" >
        <div class="container-fluid" >
            <ul class="nav navbar-nav navbar-right">
            <li class="dropdown" >
            				<a href="#" class="dropdown-toggle" data-toggle="dropdown">
            					<span th:text="${session.LOGIN_USER.getName()}"/> <b class="caret"></b>
            				</a>
            				<ul class="dropdown-menu">
            					<li><a href="/petstore/user/modifyPassword">修改密码</a></li>
            				</ul>
            </li>
                <li><a th:href="@{/cart/myCart(userId=${session.LOGIN_USER.getId()})}"><span class="glyphicon glyphicon-shopping-cart"></span>我的购物车</a></li>
                <li><a th:href="@{/user/logOut}"><span class="glyphicon glyphicon-log-out"></span>退出</a></li>
            </ul>
            <div class="navbar-header" style="margin-left: 10%;margin-right: 10%" >
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" th:href="@{/item/list}">米乐宠物商城</a>
                <img th:src="@{/assets/global/img/logo.jpg}"  width="70" height="50">
            </div>
            <div class="collapse navbar-collapse" id="myNavbar" >
                <ul class="nav navbar-nav">
                    <li class="dropdown" >
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            狗狗 <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a th:href="@{/item/listByCategory(category=1)}">狗粮</a></li>
                            <li class="divider"></li>
                            <li><a th:href="@{/item/listByCategory(category=2)}">狗狗玩具</a></li>
                            <li class="divider"></li>
                            <li><a th:href="@{/item/listByCategory(category=3)}">出行装备</a></li>
                        </ul>
                    </li>
                    <li class="dropdown" >
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            猫咪 <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a th:href="@{/item/listByCategory(category=4)}">猫粮</a></li>
                            <li class="divider"></li>
                            <li><a th:href="@{/item/listByCategory(category=5)}">猫猫玩具</a></li>
                            <li class="divider"></li>
                            <li><a th:href="@{/item/listByCategory(category=6)}">出行装备</a></li>
                        </ul>
                    </li>
                    <form class="navbar-form navbar-right" role="search">
                        <div class="form-group">
                            <input type="text" action="/item/selectByKey"class="form-control" placeholder="Search">
                        </div>
                        <button type="submit" class="btn btn-default">搜索</button>
                    </form>
                </ul>
            </div>
        </div>
    </nav>
</div>
<div class="storecontent">

<div class="storecontentw">
</div>
<div class="contentfooter">
    <div class="panel panel-default" style="width: 100%">
        <div class="panel-heading" style="background-color: #f2f9ff;width: 100px">
            我的购物车
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>商品名称</th>
                    <th>商品图片</th>
                    <th>商品价格</th>
                    <th>商品数量</th>
                    <th>商品销量</th>
                </tr>
                <tr  th:each="cartItemVO,cartItemVO : ${session.carVO.cartItemVOList}">
                    <td th:text="${cartItemVO.current.getName()}"></td>
                    <td ><img th:src="@{${cartItemVO.current.getImg_url()}}" width="100" height="100" /></td>
                    <td th:text="${cartItemVO.current.getPrice()}"></td>
                    <td th:text="${cartItemVO.current.getQuantity()}"></td>
                    <td th:text="${cartItemVO.current.getTotal()}"></td>
                </tr>
            </table>
        </div>
        <br />

    </div>
    </div>
    <div class="price" >
        <br />

            <div class ="myright">
                送货至：<select name="programme" id="programme_view">
            </select>
                <h3 text-align="right">&nbsp;总价
                    <span class="control-label hse1" th:text="${session.carVO.cartTotal}"/>￥
                    <button class="btn  btn-success btn-lg" onclick="createOrder()" id="createOrder" type="button" >
                        立即支付
                    </button>
                </h3>
            </div>
    </div>
</div>

</body>

<script>

    function createOrder() {
        var addressId = $('#programme_view option:selected') .val();
        window.location.href="/petstore/order/createOrder?addressId="+addressId;
    }
    jQuery(document).ready(function() {
        $.ajax({
            url : 'http://localhost:8090/petstore/address/myAddress',
            type : 'GET',
            contentType:"application/x-www-form-urlencoded",
            xhrFields:{withCredentials:true},
            success : function(data) {
                if(data){
                    var expressCompany = $("#programme_view");
                    expressCompany.empty();
                    for(var i=0,len=data.data.length;i<len;i++){
                        var programme = data.data[i];
                        console.log(programme['receiverZip']);
                        expressCompany.append(
                            "<option value=" + programme['id'] + ">" + programme['receiverProvince']
                            +programme['receiverCity']
                            + programme['receiverDistrict'] + programme['receiverAddress']
                            + "</option>");
                    }
                }
            },
        });
    });

</script>
</html>


